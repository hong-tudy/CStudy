[!참고용 노션 링크](https://striped-beechnut-dfe.notion.site/1331755a66e14af289d91f2a7d7f56ab?pvs=4)
# 프로세스 동기화

# 1. 동기화

## 동기화의 의미

### 동기화란?

- 프로세스 동기화 : 프로세스들 사이의 수행 시기를 맞추는 것
    - 동기화의 대상 : 실행 흐름이 있는 거 모두 동기화의 대상. (ex. 프로세스, 스레드)

### 동기화의 목표

(1) 실행 순서 제어를 위한 동기화

- 의미
- 대표적인 사례 : Reader - Writer

(2) 상호 배제를 위한 동기화

- 동시에 접근해서는 안되는 자원에 하나의 프로세스만 접근하도록 동기화한다.
- 대표적인 사례 : Producer - Consumer 문제

## 공유자원과 임계구역

### 공유자원

예시 : 전역변수, 파일, 입출력장치, 보조기억장치

### 임계구역

동시에 접근하면 문제가 발생하는 자원에 접근하는 코드 영역

### Race Condition

- race condition 문제 해결 원칙
    - 상호배제
    - 진행
    - 유한 대기

# 2. 동기화 기법

## 뮤텍스락

상호배제를 위한 동기화 도구

구성 : 전역변수 lock, acquire 함수, release 함수

특징 : Busy Wait(바쁜 대기) - lock이 해제되었는지 계속 반복문을 돌며 확인한다.

요약 : 하나의 프로세스가 실행될 떄 aquire함수에서 lock 이 풀릴때까지 기다렸다가 lock이 풀렸다면 lock을 다시 잠가 다른 프로세스가 접근하지 못하도록 하고 임계구역에 진입한다. 임계구역을 벗어날 때 release 함수를 통해 lock을 다시 해제하여 다른 프로세스들이 접근할 수 있도록 한다.

- 코드

## 세마포어

- 뮤텍스락과 다르게 공유자원이 여러개 있는 경우에도 적용이 가능하다.
- 종류 :  이진 세마포어, 카운팅 세마포어
- 바쁜 대기 대신 대기큐를 활용하는 방법이 있다.
- 구성 : 전역변수 S (진입가능한 프로세스의 수), wait 함수, signal 함수 (기차 신호 stop, go와 유사)
- 요약 : 하나의 프로세스가 임계구역에 진입하기 전 wait 함수에서 S가 0이면 while문에서 대기(바쁜 대기) or PCB가 대기 큐에 삽입된다. 0이 아니라면 임계구역에 바로 진입할 것. 현재 임계구역에서 코드를 진행 중이던 프로세스가 임계구역을 모두 지나고 나서 signal 함수 호출. signal 함수에서 S값을 늘리고 or 대기큐에 있던 프로세스의 PCB를 준비큐로 옮긴다.
- 실행순서를 위한 동기화로도 활용이 가능하다.
    - S를 0으로 두고 두번쨰로 실행할 프로세스의 앞에는 wait함수, 선행되어야 할 함수 뒤에는 signal함수를 붙인다.
- 단점 : 매번 wait, signal 함수를 앞뒤로 붙여주는 것이 대규모 프로그래밍을 할 때 번거롭고 실수를 할 경우 큰 문제가 발생한다.

## 모니터

- 인터페이스를 통해서만 공유자원에 접근이 가능
- 이 인터페이스에 진입하기 위한 큐를 만들어 한 번에 하나의 프로세스만 모니터에 접근 가능하도록 한다. (상호배제를 위한 동기화)
- 조건 변수를 달아 먼저 모니터 안에 들어오더라도 wait함수로 조건변수 큐에 삽입되어 대기 상태에 돌입한다. 선행되어야 할 프로세스가 모니터에 들어와 signal 함수를 호출하면 그 다음에 준비 상태로 변하여 다시 모니터에 진입할 수 있게 된다.  (실행 순서 제어를 위한 동기화)